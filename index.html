<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Twin Tigers Taekwondo - Portal</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-blue': '#013378',
                        'brand-red': '#ce0707',
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@600;700&display=swap');
        
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body {
            background: #ffffff;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .auth-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 480px;
            width: 100%;
            overflow: hidden;
        }

        .logo-section {
            background: #013378;
            padding: 32px;
            text-align: center;
        }

        .logo-placeholder {
            width: 120px;
            height: 120px;
            margin: 0 auto 16px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
            background: #f9fafb;
        }

        .tab {
            flex: 1;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            font-weight: 500;
            color: #6b7280;
            transition: all 0.2s;
            border-bottom: 2px solid transparent;
        }

        .tab:hover {
            background: #f3f4f6;
        }

        .tab.active {
            color: #013378;
            border-bottom-color: #ce0707;
            background: white;
        }

        .form-section {
            padding: 32px;
        }

        .input-group {
            margin-bottom: 16px;
        }

        .input-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #374151;
            font-size: 14px;
        }

        .input-field {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
        }

        .input-field:focus {
            outline: none;
            border-color: #013378;
            box-shadow: 0 0 0 3px rgba(1, 51, 120, 0.1);
        }

        .btn-primary {
            width: 100%;
            padding: 14px;
            background: #ce0707;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary:hover:not(:disabled) {
            background: #b80606;
            transform: translateY(-1px);
        }

        .btn-primary:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            width: 100%;
            padding: 14px;
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 12px;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .error-message {
            background: #fee2e2;
            color: #991b1b;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .success-message {
            background: #d1fae5;
            color: #065f46;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
            display: none;
        }

        .success-message.show {
            display: block;
        }

        .link-text {
            text-align: center;
            margin-top: 16px;
            font-size: 14px;
            color: #6b7280;
        }

        .link-text a {
            color: #013378;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
        }

        .link-text a:hover {
            text-decoration: underline;
        }

        .hidden {
            display: none;
        }

        /* Step Indicator */
        .step-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 32px;
            gap: 12px;
        }

        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #d1d5db;
            transition: all 0.3s;
        }

        .step-dot.active {
            background: #ce0707;
            transform: scale(1.2);
        }

        .step-dot.completed {
            background: #10b981;
        }

        .step-title {
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 24px;
        }

        .plan-card {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .plan-card:hover {
            border-color: #013378;
            background: #f9fafb;
        }

        .plan-card.selected {
            border-color: #ce0707;
            background: #fef2f2;
        }

        .plan-name {
            font-weight: 600;
            font-size: 16px;
            color: #111827;
            margin-bottom: 4px;
        }

        .plan-price {
            font-size: 20px;
            font-weight: 700;
            color: #ce0707;
            margin-bottom: 8px;
        }

        .plan-features {
            font-size: 13px;
            color: #6b7280;
            line-height: 1.5;
        }

        .red-pine-badge {
            text-align: center;
            padding: 20px 16px;
            font-size: 12px;
            color: #6b7280;
            border-top: 1px solid #e5e7eb;
            font-family: 'Fira Code', monospace;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .red-pine-badge a {
            color: #ce0707;
            text-decoration: none;
            font-weight: 700;
        }

        .red-pine-badge a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

    <div class="auth-card">
        <!-- Logo Section -->
        <div class="logo-section">
            <div class="logo-placeholder" id="studio-logo">
                ðŸ¥‹
            </div>
            <h1 style="color: white; font-size: 24px; font-weight: 700; margin-bottom: 8px;" class="studio-name-text">Twin Tigers Taekwondo</h1>
            <p style="color: rgba(255,255,255,0.8); font-size: 14px;">Student & Parent Portal</p>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <div class="tab active" onclick="switchTab('login')">Login</div>
            <div class="tab" onclick="switchTab('signup')">Sign Up</div>
        </div>

        <!-- Login Form -->
        <div id="login-section" class="form-section">
            <div id="login-error" class="error-message"></div>
            
            <form id="login-form" onsubmit="handleLogin(event)">
                <div class="input-group">
                    <label class="input-label">Email</label>
                    <input type="email" class="input-field" id="login-email" required placeholder="your@email.com">
                </div>

                <div class="input-group">
                    <label class="input-label">Password</label>
                    <input type="password" class="input-field" id="login-password" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                </div>

                <button type="submit" class="btn-primary" id="login-btn">
                    Sign In
                </button>
            </form>

            <div class="link-text">
                <a onclick="showForgotPassword()">Forgot password?</a>
            </div>
        </div>

        <!-- Forgot Password Form -->
        <div id="forgot-section" class="form-section hidden">
            <div id="forgot-error" class="error-message"></div>
            <div id="forgot-success" class="success-message"></div>
            
            <form id="forgot-form" onsubmit="handleForgotPassword(event)">
                <div class="input-group">
                    <label class="input-label">Email</label>
                    <input type="email" class="input-field" id="forgot-email" required placeholder="your@email.com">
                </div>

                <button type="submit" class="btn-primary" id="forgot-btn">
                    Send Reset Link
                </button>

                <button type="button" class="btn-secondary" onclick="showLogin()">
                    Back to Login
                </button>
            </form>
        </div>

        <!-- Signup Form (3 Steps) -->
        <div id="signup-section" class="form-section hidden">
            <div id="signup-error" class="error-message"></div>
            <div id="signup-success" class="success-message"></div>

            <!-- Step Indicator -->
            <div class="step-indicator">
                <div class="step-dot active" id="dot-1"></div>
                <div class="step-dot" id="dot-2"></div>
                <div class="step-dot" id="dot-3"></div>
            </div>

            <!-- Step 1: Choose Plan -->
            <div id="step-1" class="signup-step">
                <div class="step-title">Choose Your Membership</div>

                <div class="plan-card" onclick="selectPlan('Standard')">
                    <div class="plan-name">Standard</div>
                    <div class="plan-price">$75/month</div>
                    <div class="plan-features">
                        â€¢ Access to basic classes<br>
                        â€¢ Standard training schedule<br>
                        â€¢ Belt progression tracking
                    </div>
                </div>

                <div class="plan-card" onclick="selectPlan('Silver')">
                    <div class="plan-name">Silver</div>
                    <div class="plan-price">$100/month</div>
                    <div class="plan-features">
                        â€¢ All Standard benefits<br>
                        â€¢ Priority class scheduling<br>
                        â€¢ 1 guest pass per month
                    </div>
                </div>

                <div class="plan-card" onclick="selectPlan('Gold')">
                    <div class="plan-name">Gold</div>
                    <div class="plan-price">$120/month</div>
                    <div class="plan-features">
                        â€¢ All Silver benefits<br>
                        â€¢ Unlimited classes<br>
                        â€¢ Competition support<br>
                        â€¢ Private lesson discounts
                    </div>
                </div>

                <button type="button" class="btn-primary" onclick="goToStep2()" id="plan-next-btn" disabled>
                    Continue
                </button>
            </div>

            <!-- Step 2: Parent Info -->
            <div id="step-2" class="signup-step hidden">
                <div class="step-title">Parent Information</div>

                <form id="parent-form">
                    <div class="input-group">
                        <label class="input-label">First Name</label>
                        <input type="text" class="input-field" id="parent-first-name" required>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Last Name</label>
                        <input type="text" class="input-field" id="parent-last-name" required>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Email</label>
                        <input type="email" class="input-field" id="parent-email" required>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Phone</label>
                        <input type="tel" class="input-field" id="parent-phone" required placeholder="(555) 555-5555">
                    </div>

                    <div class="input-group">
                        <label class="input-label">Password</label>
                        <input type="password" class="input-field" id="parent-password" required minlength="6">
                    </div>

                    <div class="input-group">
                        <label class="input-label">Emergency Contact</label>
                        <input type="text" class="input-field" id="emergency-contact" required placeholder="Name & Phone">
                    </div>

                    <button type="button" class="btn-primary" onclick="goToStep3()">
                        Continue
                    </button>

                    <button type="button" class="btn-secondary" onclick="goToStep1()">
                        Back
                    </button>
                </form>
            </div>

            <!-- Step 3: Student Info -->
            <div id="step-3" class="signup-step hidden">
                <div class="step-title">Student Information</div>

                <div id="students-container">
                    <!-- Student form will be dynamically added here -->
                </div>

                <button type="button" class="btn-secondary" onclick="addAnotherStudent()" id="add-student-btn">
                    + Add Another Student
                </button>

                <button type="button" class="btn-primary" onclick="handleSignup()" id="complete-signup-btn" style="margin-top: 16px;">
                    Complete Sign Up
                </button>

                <button type="button" class="btn-secondary" onclick="goToStep2()">
                    Back
                </button>
            </div>
        </div>

        <!-- Red Pine Badge -->
        <div class="red-pine-badge">
            POWERED BY <a href="https://redpinemarketing.com" target="_blank">RED PINE</a>
        </div>
    </div>

    <script>
        // Supabase config
        const SUPABASE_URL = 'https://ipvutcoacitpcaeynexr.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_uNb-_pIYGvhM_kDAq9wvJA_gOiZwSf9';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Global signup data
        let signupData = {
            plan: null,
            planPrice: null,
            students: []
        };

        let studentCounter = 0;

        // Check auth on load
        async function checkAuth() {
            const { data: { session } } = await supabase.auth.getSession();
            
            if (session) {
                const { data: profile } = await supabase
                    .from('profiles')
                    .select('role')
                    .eq('id', session.user.id)
                    .single();
                
                if (profile?.role === 'owner') {
                    window.location.href = 'owner_portal.html';
                } else {
                    window.location.href = 'parent_portal.html';
                }
            }
        }

        checkAuth();

        // Tab switching
        function switchTab(tab) {
            // Update tabs
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            // Hide all sections
            document.getElementById('login-section').classList.add('hidden');
            document.getElementById('signup-section').classList.add('hidden');
            document.getElementById('forgot-section').classList.add('hidden');

            // Show selected section
            if (tab === 'login') {
                document.getElementById('login-section').classList.remove('hidden');
            } else if (tab === 'signup') {
                document.getElementById('signup-section').classList.remove('hidden');
                goToStep1(); // Reset to step 1
            }
        }

        // Show forgot password
        function showForgotPassword() {
            document.getElementById('login-section').classList.add('hidden');
            document.getElementById('forgot-section').classList.remove('hidden');
        }

        // Show login
        function showLogin() {
            document.getElementById('forgot-section').classList.add('hidden');
            document.getElementById('login-section').classList.remove('hidden');
        }

        // Plan selection
        function selectPlan(plan) {
            // Remove selected from all cards
            document.querySelectorAll('.plan-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Add selected to clicked card
            event.target.closest('.plan-card').classList.add('selected');

            // Store plan data
            const prices = { 'Standard': 75, 'Silver': 100, 'Gold': 120 };
            signupData.plan = plan;
            signupData.planPrice = prices[plan];

            // Enable continue button
            document.getElementById('plan-next-btn').disabled = false;
        }

        // Step navigation
        function goToStep1() {
            document.getElementById('step-1').classList.remove('hidden');
            document.getElementById('step-2').classList.add('hidden');
            document.getElementById('step-3').classList.add('hidden');
            updateStepIndicator(1);
        }

        function goToStep2() {
            if (!signupData.plan) {
                showError('signup-error', 'Please select a membership plan');
                return;
            }

            document.getElementById('step-1').classList.add('hidden');
            document.getElementById('step-2').classList.remove('hidden');
            document.getElementById('step-3').classList.add('hidden');
            updateStepIndicator(2);
        }

        function goToStep3() {
            // Validate parent form
            const form = document.getElementById('parent-form');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            // Add first student form if none exist
            if (studentCounter === 0) {
                addStudentForm();
            }

            document.getElementById('step-1').classList.add('hidden');
            document.getElementById('step-2').classList.add('hidden');
            document.getElementById('step-3').classList.remove('hidden');
            updateStepIndicator(3);
        }

        function addStudentForm() {
            studentCounter++;
            const container = document.getElementById('students-container');
            
            const studentDiv = document.createElement('div');
            studentDiv.className = 'student-form-section';
            studentDiv.id = `student-${studentCounter}`;
            studentDiv.style.marginBottom = '24px';
            studentDiv.style.paddingBottom = '24px';
            studentDiv.style.borderBottom = '1px solid #e5e7eb';
            
            studentDiv.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <h3 style="font-weight: 600; color: #111827;">Student ${studentCounter}</h3>
                    ${studentCounter > 1 ? `<button type="button" onclick="removeStudent(${studentCounter})" style="color: #ef4444; font-size: 14px; background: none; border: none; cursor: pointer; font-weight: 500;">Remove</button>` : ''}
                </div>

                <div class="input-group">
                    <label class="input-label">First Name</label>
                    <input type="text" class="input-field student-input" data-field="firstName" data-student="${studentCounter}" required>
                </div>

                <div class="input-group">
                    <label class="input-label">Last Name</label>
                    <input type="text" class="input-field student-input" data-field="lastName" data-student="${studentCounter}" required>
                </div>

                <div class="input-group">
                    <label class="input-label">Age</label>
                    <input type="number" class="input-field student-input" data-field="age" data-student="${studentCounter}" required min="4" max="99">
                </div>

                <div class="input-group">
                    <label class="input-label">Date of Birth</label>
                    <input type="date" class="input-field student-input" data-field="dob" data-student="${studentCounter}" required>
                </div>

                <div class="input-group">
                    <label class="input-label">Medical Conditions (optional)</label>
                    <textarea class="input-field student-input" data-field="medical" data-student="${studentCounter}" rows="2" placeholder="Any medical conditions we should know about"></textarea>
                </div>
            `;
            
            container.appendChild(studentDiv);
        }

        function addAnotherStudent() {
            addStudentForm();
        }

        function removeStudent(studentNum) {
            const studentDiv = document.getElementById(`student-${studentNum}`);
            if (studentDiv) {
                studentDiv.remove();
            }
        }

        function collectStudentData() {
            const students = [];
            const studentSections = document.querySelectorAll('.student-form-section');
            
            studentSections.forEach(section => {
                const inputs = section.querySelectorAll('.student-input');
                const student = {};
                
                inputs.forEach(input => {
                    const field = input.getAttribute('data-field');
                    student[field] = input.value;
                });
                
                if (student.firstName) { // Only add if has data
                    students.push(student);
                }
            });
            
            return students;
        }

        function updateStepIndicator(step) {
            document.querySelectorAll('.step-dot').forEach((dot, index) => {
                dot.classList.remove('active', 'completed');
                if (index + 1 < step) {
                    dot.classList.add('completed');
                } else if (index + 1 === step) {
                    dot.classList.add('active');
                }
            });
        }

        // Login handler
        async function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const btn = document.getElementById('login-btn');
            
            btn.disabled = true;
            btn.textContent = 'Signing in...';
            hideError('login-error');
            
            try {
                const { data, error } = await supabase.auth.signInWithPassword({ 
                    email, 
                    password 
                });
                
                if (error) throw error;
                
                const { data: profile } = await supabase
                    .from('profiles')
                    .select('role')
                    .eq('id', data.user.id)
                    .single();
                
                if (profile?.role === 'owner') {
                    window.location.href = 'owner_portal.html';
                } else {
                    window.location.href = 'parent_portal.html';
                }
                
            } catch (error) {
                showError('login-error', error.message);
                btn.disabled = false;
                btn.textContent = 'Sign In';
            }
        }

        // Forgot password handler
        async function handleForgotPassword(e) {
            e.preventDefault();
            
            const email = document.getElementById('forgot-email').value;
            const btn = document.getElementById('forgot-btn');
            
            btn.disabled = true;
            btn.textContent = 'Sending...';
            hideError('forgot-error');
            hideSuccess('forgot-success');
            
            try {
                const { error } = await supabase.auth.resetPasswordForEmail(email);
                if (error) throw error;
                
                showSuccess('forgot-success', 'Password reset email sent! Check your inbox.');
                btn.disabled = false;
                btn.textContent = 'Send Reset Link';
                
            } catch (error) {
                showError('forgot-error', error.message);
                btn.disabled = false;
                btn.textContent = 'Send Reset Link';
            }
        }

        // Signup handler
        async function handleSignup() {
            const btn = document.getElementById('complete-signup-btn');
            btn.disabled = true;
            btn.textContent = 'Creating account...';
            hideError('signup-error');
            
            try {
                // Collect student data
                const students = collectStudentData();
                
                if (students.length === 0) {
                    showError('signup-error', 'Please add at least one student.');
                    btn.disabled = false;
                    btn.textContent = 'Complete Sign Up';
                    return;
                }

                // Validate all student forms
                const allInputs = document.querySelectorAll('.student-input[required]');
                let isValid = true;
                allInputs.forEach(input => {
                    if (!input.value) {
                        input.style.borderColor = '#ef4444';
                        isValid = false;
                    } else {
                        input.style.borderColor = '';
                    }
                });

                if (!isValid) {
                    showError('signup-error', 'Please fill in all required student fields.');
                    btn.disabled = false;
                    btn.textContent = 'Complete Sign Up';
                    return;
                }

                // Gather parent data
                const parentFirstName = document.getElementById('parent-first-name').value;
                const parentLastName = document.getElementById('parent-last-name').value;
                const email = document.getElementById('parent-email').value;
                const phone = document.getElementById('parent-phone').value;
                const password = document.getElementById('parent-password').value;
                const emergencyContact = document.getElementById('emergency-contact').value;

                // Create Supabase auth user
                const { data, error } = await supabase.auth.signUp({
                    email,
                    password,
                    options: {
                        data: {
                            full_name: `${parentFirstName} ${parentLastName}`,
                            role: 'parent',
                            phone: phone
                        }
                    }
                });

                if (error) throw error;
                
                // Create profile
                if (data.user) {
                    await supabase.from('profiles').insert({
                        id: data.user.id,
                        email: email,
                        full_name: `${parentFirstName} ${parentLastName}`,
                        role: 'parent',
                        studio_id: 'twin-tigers'
                    });

                    // Generate Parent ID
                    const timestamp = Date.now();
                    const parentId = 'PAR-' + timestamp;
                    const today = new Date().toISOString().split('T')[0];

                    // Create student records in Sheets
                    const studentNames = [];
                    for (let i = 0; i < students.length; i++) {
                        const student = students[i];
                        const studentId = 'STU-' + (timestamp + i);
                        
                        studentNames.push(`${student.firstName} ${student.lastName}`);

                        const studentData = {
                            Student_Id: studentId,
                            First_Name: student.firstName,
                            Last_Name: student.lastName,
                            Age: student.age,
                            Date_of_Birth: student.dob,
                            Belt_Rank: 'White Belt',
                            Parent_Email: email,
                            Parent_Id: parentId,
                            Medical_Conditions: student.medical || '',
                            Emergency_Contact: emergencyContact,
                            Enrollment_Date: today,
                            Status: 'Active',
                            Notes: '',
                            Membership_Plan: signupData.plan
                        };

                        await fetch('https://sheetdb.io/api/v1/7gridxho6ejta?sheet=Students', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ data: studentData })
                        });
                    }

                    // Create parent record in Sheets
                    const parentData = {
                        Parent_Id: parentId,
                        First_Name: parentFirstName,
                        Last_Name: parentLastName,
                        Email: email,
                        Phone: phone,
                        Related_Students: studentNames.join(', '),
                        Emergency_Contact: emergencyContact,
                        Membership_Plan: signupData.plan,
                        Membership_Price: signupData.planPrice,
                        Membership_Status: 'unpaid'
                    };
                    
                    await fetch('https://sheetdb.io/api/v1/7gridxho6ejta?sheet=Parents', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ data: parentData })
                    });
                }
                
                // Show success and redirect to parent portal
                showSuccess('signup-success', 'Account created! Redirecting to your portal...');
                
                // Auto-login and redirect to parent portal
                setTimeout(async () => {
                    const { error: loginError } = await supabase.auth.signInWithPassword({
                        email,
                        password
                    });
                    
                    if (!loginError) {
                        window.location.href = 'parent_portal.html';
                    }
                }, 1500);
                
            } catch (error) {
                console.error(error);
                showError('signup-error', error.message || 'Something went wrong. Please try again.');
                btn.disabled = false;
                btn.textContent = 'Complete Sign Up';
            }
        }

        // Error/Success helpers
        function showError(id, message) {
            const el = document.getElementById(id);
            el.textContent = message;
            el.classList.add('show');
        }

        function hideError(id) {
            const el = document.getElementById(id);
            el.classList.remove('show');
        }

        function showSuccess(id, message) {
            const el = document.getElementById(id);
            el.textContent = message;
            el.classList.add('show');
        }

        function hideSuccess(id) {
            const el = document.getElementById(id);
            el.classList.remove('show');
        }

        // Load studio branding
        document.addEventListener('DOMContentLoaded', () => {
            try {
                const studioName = localStorage.getItem('studioName');
                const studioNameEls = document.querySelectorAll('.studio-name-text');
                if (studioName && studioNameEls.length) {
                    studioNameEls.forEach(el => el.textContent = studioName);
                }

                const savedLogo = localStorage.getItem('studioLogo');
                const logoEl = document.getElementById('studio-logo');
                if (logoEl && savedLogo) {
                    logoEl.innerHTML = `<img src="${savedLogo}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 12px;">`;
                }
            } catch (err) {
                console.error('Error loading studio settings:', err);
            }
        });
    </script>
</body>
</html>
